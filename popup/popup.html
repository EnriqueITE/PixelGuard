<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>PixelGuard</title>
    <style>
      :root { --bg:#0b0d0f; --fg:#e6f1ef; --muted:#b5c9c3; --accent:#00e676; --danger:#e53935; --panel:#121517; --border:#2b363c; --s:#e53935; --e:#00bfa5; --l:#ff9800; }
      html, body { background: var(--bg); color: var(--fg); }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, sans-serif; margin: 12px; }
      h3 { margin: 0 0 10px; color:#7df9b9; letter-spacing:.2px; }
      .row { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:10px; flex-wrap: nowrap; }
      .row-compact { justify-content:flex-start; }
      .panel { background: var(--panel); border:1px solid var(--border); border-left:4px solid var(--accent); border-radius:8px; padding:10px; }
      .muted { color: var(--muted); }
      .stat { font-weight:700; }
      a { color: #7df9b9; }
      button { padding:6px 10px; border-radius:6px; border:1px solid var(--border); background:#1a1f23; color:var(--fg); cursor:pointer; }
      button:hover { background:#22272b; }
      #toggle.on { background: #0c8; border-color:#0b7; color:#082017; }
      #toggle.off { background: var(--danger); border-color:#b71c1c; }
      .chips { display:flex; gap:8px; align-items:center; }
      .chip { display:inline-flex; align-items:center; gap:6px; padding:3px 10px; border-radius:16px; font-weight:700; }
      .chip-s { background: var(--s); color:#fff; }
      .chip-e { background: var(--e); color:#001814; }
      .chip-l { background: var(--l); color:#1a1a1a; }
      .badge-sm { display:inline-flex; align-items:center; justify-content:center; min-width:18px; height:18px; padding:0 6px; border-radius:12px; font-weight:700; font-size:11px; line-height:1; background: var(--danger); color:#fff; border:1px solid #b71c1c; }
      .muted-badge { background:#2b363c; color:#c7d5d0; border-color:#2b363c; }
      .muted-note { font-size:11px; opacity:0.85; margin-left:6px; }
    </style>
  </head>
  <body>
    <div class="panel">
      <h3 data-i18n="extensionName">PixelGuard</h3>
      <div class="row">
        <span class="muted" data-i18n="ui_blockMode">Blocking mode</span>
        <div style="display:flex; align-items:center; gap:8px;">
          <button id="toggle"></button>
          <span id="blockedBadge" class="badge-sm" style="display:none;" title="Blocked (total)">0</span>
        </div>
      </div>
      <div class="row" id="rowTotalDetected"><span><span class="muted" data-i18n="ui_detectedTotal">Detected (total):</span><span class="muted muted-note" data-i18n="ui_sinceInstall">since installation</span></span> <span class="stat" id="detected">0</span></div>
      <div class="row" id="rowTotalBlocked"><span><span class="muted" data-i18n="ui_blockedTotal">Blocked (total):</span><span class="muted muted-note" data-i18n="ui_sinceInstall">since installation</span></span> <span class="stat" id="blocked">0</span></div>
      <!-- Global section only: totals and toggle. Per-message chips moved below. -->
      <div class="row"><button id="openOptions" data-i18n="ui_openOptions">Open Options</button></div>
    </div>
    <div class="panel">
      <h3 data-i18n="popup_thisMessage">This message</h3>
      <div class="row">
        <span class="muted" data-i18n="popup_summary">Summary</span>
        <div class="chips">
          <div class="chip chip-s"><span id="sumS">0</span><span data-i18n="popup_label_pixels">pixels</span></div>
          <div class="chip chip-e"><span id="sumE">0</span><span data-i18n="popup_label_images">images</span></div>
          <div class="chip chip-l"><span id="sumL">0</span><span data-i18n="popup_label_links">links</span></div>
        </div>
      </div>
      <div class="row">
        <span class="muted" data-i18n="popup_senderDomain">Sender domain</span>
        <span id="senderDomain" class="stat">-</span>
        <button id="toggleWL" data-i18n="popup_whitelistAdd">Whitelist</button>
      </div>
      <!-- Detailed rows hidden to reduce repetition; summary pills above show counts -->
      <div class="row" style="display:none"><span class="muted" data-i18n="popup_suspiciousPixels">Suspicious pixels</span><span class="stat" id="suspCount">0</span></div>
      <div class="row" style="display:none"><span class="muted" data-i18n="popup_externalImages">External images</span><span class="stat" id="extCount">0</span></div>
      <div class="row" style="display:none"><span class="muted" data-i18n="popup_trackingLinks">Tracking links</span><span class="stat" id="linkCount">0</span></div>
      <div class="row"><span class="muted" data-i18n="popup_scannedAt">Scanned at</span><span id="scanTs">-</span></div>
      <div class="row row-compact"><button id="rescan" data-i18n="popup_rescan">Rescan now</button><span id="scanStatus" class="muted" style="margin-left:8px;"></span></div>
      <div style="margin-top:8px">
        <details id="detailsList">
          <summary data-i18n="popup_showDetails">Show details</summary>
          <ul id="list"></ul>
        </details>
      </div>
    </div>
    <div class="muted" style="font-size:12px; text-align:center; margin-top:8px;">
      <a href="https://buymeacoffee.com/enriqueite" target="_blank" rel="noopener noreferrer" data-i18n="ui_buyCoffee">Buy me a coffee</a>
    </div>
    <script src="popup.js"></script>
  </body>
  </html>
